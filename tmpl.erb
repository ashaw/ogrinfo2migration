class Add<%= @attributes["layer_name"].camelize %> < ActiveRecord::Migration
  def change
    create_table :<%= @attributes["layer_name"].pluralize %> do |t|
      <% @attributes.reject {|k,v| k == "layer_name" }.each do |name, type| %>
        t.<%= type %> :<%= name %>
      <% end %>
      <% if @epsg %>
        t.spatial :the_geom, limit: {:srid=><%= @epsg %>, :type=>"geometry"}
      <% end %>
    end
    <% if @epsg %>
      add_index :<%= @attributes["layer_name"].pluralize %>, ["the_geom"], :name => "<%= @attributes["layer_name"].pluralize %>_geometry_gist", :spatial => true    
    <% end %>
  end
end
